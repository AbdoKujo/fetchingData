<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Exercise 2: Dog Images</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      max-width: 1000px;
      margin: 0 auto;
      padding: 20px;
      background-color: #f5f5f5;
    }
    h1 {
      color: #333;
      text-align: center;
    }
    .controls {
      margin-bottom: 20px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    #breedSearch {
      flex: 1;
      min-width: 200px;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
    }
    #breedSelect {
      flex: 2;
      min-width: 300px;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
    }
    .image-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 15px;
    }
    .image-item {
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      aspect-ratio: 1;
    }
    .image-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }
    .loading {
      text-align: center;
      padding: 20px;
      font-style: italic;
      color: #666;
    }
    .no-results {
      text-align: center;
      padding: 20px;
      color: #666;
    }
  </style>
</head>
<body>
  <h1>Dog Image Browser</h1>
  
  <div class="controls">
    <input type="text" id="breedSearch" placeholder="Search for a breed...">
    <select id="breedSelect">
      <option value="">-- Select a breed --</option>
    </select>
  </div>
  
  <div id="imageContainer" class="image-grid"></div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const breedSelect = document.getElementById('breedSelect');
      const breedSearch = document.getElementById('breedSearch');
      const imageContainer = document.getElementById('imageContainer');
      
      let allBreeds = [];
      
      // Function to fetch all dog breeds
      async function fetchBreeds() {
        try {
          imageContainer.innerHTML = '<div class="loading">Loading breeds...</div>';
          
          const response = await fetch('https://dog.ceo/api/breeds/list/all');
          if (!response.ok) {
            throw new Error('Failed to fetch breeds');
          }
          
          const data = await response.json();
          
          if (data.status === 'success') {
            // Convert the breed object to a flat array
            allBreeds = Object.entries(data.message).flatMap(([breed, subBreeds]) => {
              if (subBreeds.length === 0) {
                return [breed];
              } else {
                return subBreeds.map(subBreed => `${breed}/${subBreed}`);
              }
            });
            
            populateBreedSelect(allBreeds);
            imageContainer.innerHTML = '<div class="no-results">Select a breed to see images</div>';
          } else {
            throw new Error('API returned an error');
          }
        } catch (error) {
          imageContainer.innerHTML = `<div class="no-results">Error: ${error.message}</div>`;
        }
      }
      
      // Function to populate the breed select dropdown
      function populateBreedSelect(breeds) {
        // Clear all options except the first one
        breedSelect.innerHTML = '<option value="">-- Select a breed --</option>';
        
        // Add each breed as an option
        breeds.forEach(breed => {
          const option = document.createElement('option');
          option.value = breed;
          // Capitalize the breed name for display
          option.textContent = breed.split('/').map(part => 
            part.charAt(0).toUpperCase() + part.slice(1)
          ).join(' ');
          
          breedSelect.appendChild(option);
        });
      }
      
      // Function to fetch images for a selected breed
      async function fetchBreedImages(breed) {
        try {
          imageContainer.innerHTML = '<div class="loading">Loading images...</div>';
          
          const response = await fetch(`https://dog.ceo/api/breed/${breed}/images`);
          if (!response.ok) {
            throw new Error('Failed to fetch images');
          }
          
          const data = await response.json();
          
          if (data.status === 'success') {
            displayImages(data.message);
          } else {
            throw new Error('API returned an error');
          }
        } catch (error) {
          imageContainer.innerHTML = `<div class="no-results">Error: ${error.message}</div>`;
        }
      }
      
      // Function to display images in the grid
      function displayImages(images) {
        imageContainer.innerHTML = '';
        
        if (images.length === 0) {
          imageContainer.innerHTML = '<div class="no-results">No images found</div>';
          return;
        }
        
        // Display up to 20 images to avoid performance issues
        const imagesToShow = images.slice(0, 20);
        
        imagesToShow.forEach(imageUrl => {
          const imageDiv = document.createElement('div');
          imageDiv.className = 'image-item';
          
          const img = document.createElement('img');
          img.src = imageUrl;
          img.alt = 'Dog image';
          img.loading = 'lazy';
          
          imageDiv.appendChild(img);
          imageContainer.appendChild(imageDiv);
        });
      }
      
      // Function to filter breeds based on search input
      function filterBreeds(searchTerm) {
        if (!searchTerm) {
          return allBreeds;
        }
        
        searchTerm = searchTerm.toLowerCase();
        return allBreeds.filter(breed => 
          breed.toLowerCase().includes(searchTerm)
        );
      }
      
      // Event listener for breed selection
      breedSelect.addEventListener('change', () => {
        const selectedBreed = breedSelect.value;
        if (selectedBreed) {
          fetchBreedImages(selectedBreed);
        } else {
          imageContainer.innerHTML = '<div class="no-results">Select a breed to see images</div>';
        }
      });
      
      // Event listener for search input
      breedSearch.addEventListener('input', () => {
        const searchTerm = breedSearch.value.trim();
        const filteredBreeds = filterBreeds(searchTerm);
        populateBreedSelect(filteredBreeds);
      });
      
      // Initial load of breeds
      fetchBreeds();
    });
  </script>
</body>
</html>

